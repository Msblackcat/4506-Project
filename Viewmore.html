<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Legend Motor Company</title>
        <link rel="stylesheet" href="Viewmore.css">
        <script src="js/jquery-1.11.1.js"></script>
        <script>
$(document).ready(function() {
    function checkLoginState() {
        const username = localStorage.getItem('loggedInUser');
        if(username) {
            updateNavigation(username); 
        }
    }

    function updateNavigation(username) {
        if (username) {
            const loginRegisterLi = $('li.dropdown:last');
            loginRegisterLi.html(`
                <a href="#" class="user-profile">${username} â–¼</a>
                <ul class="dropdown-content">
                    <li><a href="profile.html">Profile</a></li>
                    <li><a href="#" onclick="handleLogout(event)">Logout</a></li>
                </ul>
            `);
        } else {
            const loginRegisterLi = $('li.dropdown:last');
            loginRegisterLi.html(`
                <a id="login-register" href="login.html">Login/Register</a>
                <ul class="dropdown-content">
                    <li><a href="login.html">Login</a></li>
                    <li><a href="register.html">Register</a></li>
                </ul>
            `);
        }
    }

    function handleLogout(event) {
        event.preventDefault();
        localStorage.removeItem('loggedInUser');
        localStorage.removeItem('userType');
        localStorage.removeItem('email');
        localStorage.removeItem('permissions');
        updateNavigation(null);
        window.location.href = 'index.html';
    }

    $('.dropdown').hover(
        function() {
            $(this).children('.dropdown-content').show();
        },
        function() {
            $(this).children('.dropdown-content').hide();
        }
    );

    $("#searchBar").on("keyup",function(){

        var searchValue = $('#searchBar').val().toLowerCase();


        $('.product-card').each(function() {

            var title = $(this).find('h3').text().toLowerCase();
            var matchesSearch = title.includes(searchValue);
            if (matchesSearch) {
                $(this).show();
            } else {
                $(this).hide();
            }
        });
    });

    $('#brandFilter, #priceFilter').change(function(){
        var selectedBrand = $('#brandFilter').val();
        var selectedPriceRange = $('#priceFilter').val();

        $('.product-card').each(function() {

            var brand = $(this).data('brand');
            var priceText = $(this).find('.price').text().replace(/[^0-9]/g, '');
            var price = parseInt(priceText, 10);


            var matchesBrand = !selectedBrand || brand === selectedBrand;
            var matchesPrice = true;

            if (selectedPriceRange) {
                if (selectedPriceRange === "0-5000000") {
                    matchesPrice = price < 5000000;
                } else if (selectedPriceRange === "5000000-10000000") {
                    matchesPrice = price >= 5000000 && price <= 10000000;
                } else if (selectedPriceRange === "10000000") {
                    matchesPrice = price > 10000000;
                }
            }

            if (matchesBrand && matchesPrice) {
                $(this).show();
            } else {
                $(this).hide();
            }
        });
    });

    $('.details-button').click(function() {
        var imagePath = $(this).data('image');
        var seating = $(this).data('seating');
        var fuel = $(this).data('fuel');
        var transmission = $(this).data('transmission');
        var engine = $(this).data('engine');
        var mileage = $(this).data('mileage');

        $('#modalDetails').html(`
            <div class="modal-left">
                <img src="${imagePath}" alt="Car Image" class="modal-image">
            </div>
            <h3>Vehicle Details</h3>
            <p><strong>Seating Capacity:</strong> ${seating}</p>
            <p><strong>Fuel Type:</strong> ${fuel}</p>
            <p><strong>Transmission:</strong> ${transmission}</p>
            <p><strong>Engine:</strong> ${engine}</p>
            <p><strong>Mileage:</strong> ${mileage}</p>
        `);

        $('#detailsModal').fadeIn();
    });

    $('.close').click(function() {
        $('#detailsModal').fadeOut();
    });

    $(window).click(function(event) {
        if ($(event.target).is('#detailsModal')) {
            $('#detailsModal').fadeOut();
        }
    });

    window.handleLogout = handleLogout;

    checkLoginState();
});
        </script>
    </head>
    <body>
        <header class="header"></header>
        <nav class="navbar">
            <ul class="nav-links">
                <li class="dropdown">
                    <a href="index.html">Home</a>
                </li>
                <li class="dropdown">
                    <a href="#">View some more</a>
                    <ul class="dropdown-content">
                        <li><a href="Viewmore.html">All</a></li>
                        <li><a href="Viewmore.html">Type1</a></li>
                        <li><a href="Viewmore.html">Type2</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#">Wish List</a>
                    <ul class="dropdown-content">
                        <li><a href="#">Consulting</a></li>
                        <li><a href="#">Support</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a id="login-register" href="login.html">Login/Register</a>
                    <ul class="dropdown-content">
                        <li><a href="login.html">Login</a></li>
                        <li><a href="register.html">Register</a></li>
                    </ul>
                </li>
            </ul>
        </nav>

        <div class="search-container">

            <select id="brandFilter" class="filter-dropdown">
                <option value="">Brand</option>
                <option value="Aston Martin">Aston Martin</option>
                <option value="Ferrari">Ferrari</option>
                <option value="Toyota">Toyota</option>
            </select>

            <select id="priceFilter" class="filter-dropdown">
                <option value="">Price</option>
                <option value="0-5000000">Below HK$5,000,000</option>
                <option value="5000000-10000000">HK$5,000,000 - HK$10,000,000</option>
                <option value="10000000">Above HK$10,000,000</option>
            </select>

            <input type="text" id="searchBar" placeholder="Search vehicles...">
        </div>

        <div class="products-grid" id="productGrid">
            <div class="product-card" data-brand="Aston Martin">
                <img src="/4506_source/product1_black.png" alt="Car Image">
                <h3>Aston Martin Valkyrie</h3>
                <p>Year: 2017<br>Mileage: 0 Kilometer<br>Engine: 6.5 Litre Aston Martin V12</p>
                <div class="price">HK$27,194,921</div>
                <button 
                class="details-button" 
                data-image="/4506_source/product1_black.png"
                data-seating="4 seats" 
                data-fuel="Petrol" 
                data-transmission="Automatic" 
                data-engine="6.5 Litre V12" 
                data-mileage="0 Kilometer">Details</button>
                <button class="buy-button" onclick="location.href='purchase.html'">Buy Now</button>
            </div>

            <div class="product-card" data-brand="Ferrari">
                <img src="/4506_source/product2_black.png" alt="Car Image">
                <h3>Ferrari 477</h3>
                <p>Year: 2019<br>Mileage: 10,000 Kilometer<br>Engine: 3.9 Litre V8</p>
                <div class="price">HK$5,000,000</div>
                <button 
                class="details-button" 
                data-image="/4506_source/product2_black.png"
                data-seating="2 seats" 
                data-fuel="Petrol" 
                data-transmission="Manual" 
                data-engine="3.9 Litre V8" 
                data-mileage="10,000 Kilometer">Details</button>
                <button class="buy-button" onclick="location.href='purchase.html'">Buy Now</button>
            </div>

            <div class="product-card" data-brand="Ferrari">
                <img src="/4506_source/product3_blue.png" alt="Car Image"><br>
                <br><h3>Ferrari 488</h3>
                <p>Year: 2019<br>Mileage: 10,000 Kilometer<br>Engine: 3.9 Litre V8</p>
                <div class="price">HK$7,000,000</div>
                <button 
                class="details-button" 
                data-image="/4506_source/product3_blue.png"
                data-seating="4 seats" 
                data-fuel="Petrol" 
                data-transmission="Automatic" 
                data-engine="6.5 Litre V12" 
                data-mileage="0 Kilometer">Details</button>
                <button class="buy-button" onclick="location.href='purchase.html'">Buy Now</button>
            </div>
            
            <div class="product-card" data-brand="Toyota">
                <img src="/4506_source/toyota_gray.jpg" alt="Car Image">
                <h3>Toyota 568</h3>
                <p>Year: 2019<br>Mileage: 10,000 Kilometer<br>Engine: 3.9 Litre V8</p>
                <div class="price">HK$7,000,000</div>
                <button 
                class="details-button"
                data-image="/4506_source/toyota_gray.jpg"
                data-seating="4 seats" 
                data-fuel="Petrol" 
                data-transmission="Automatic" 
                data-engine="6.5 Litre V12" 
                data-mileage="0 Kilometer">Details</button>
                <button class="buy-button" onclick="location.href='purchase.html'">Buy Now</button>
            </div>

            <div class="product-card" data-brand="Aston Martin">
                <img src="/4506_source/Aston Martin_black.jpg" alt="Car Image">
                <h3>Aston Martin 888</h3>
                <p>Year: 2019<br>Mileage: 10,000 Kilometer<br>Engine: 3.9 Litre V8</p>
                <div class="price">HK$500,000</div>
                <button 
                class="details-button"
                data-image="/4506_source/toyota_gray.jpg"
                data-seating="4 seats" 
                data-fuel="Petrol" 
                data-transmission="Automatic" 
                data-engine="6.5 Litre V12" 
                data-mileage="0 Kilometer">Details</button>
                <button class="buy-button" onclick="location.href='purchase.html'">Buy Now</button>
            </div>
        </div>

        <div id="detailsModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div id="modalDetails">
                    <h3>Vehicle Details</h3>
                    <p><strong>Seating Capacity:</strong> 4 seats</p>
                    <p><strong>Fuel Type:</strong> Petrol</p>
                    <p><strong>Transmission:</strong> Automatic</p>
                    <p><strong>Engine:</strong> 6.5 Litre V12</p>
                    <p><strong>Mileage:</strong> 0 Kilometer</p>
                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="footer-section">
                <h3>Contact us</h3>
                <p>Telephone: +852 2180000</p>
                <p>Email: Services@legendmotor.com</p>
                <p>Address: No. 21 Yuen Wo Road, Sha Tin, New Territories</p>
            </div>
            <div class="footer-section">
                <h3>Business Hours</h3>
                <p>Monday - Friday: 09:00-21:00</p>
                <p>Weekend: 10:00-20:00</p>
            </div>
            <div class="footer-section">
                <h3>Follow us</h3>
                <p>Facebook</p>
                <p>Instagram</p>
                <p>LINE</p>
            </div>
        </footer>
    </body>
</html>